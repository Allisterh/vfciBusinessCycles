---
title: "BCA Replication: Classical VAR IRFs, Bootsstrapped"
author: Matthew DeHaven
date: July 25, 2023
output: 
    pdf_document
---
```{r setup, include = FALSE}
require(here)
require(data.table)
require(dplyr)
require(ggplot2)
```

# What is being replicated
The goal is to replicate Figure 20 of the Online Appendix, copied below.

```{r fig20, echo = F, fig.cap="Figure 20: Impulse Response Functions to the MBC Shock: Bayesian vs Classical Inference", out.width = "100%"}
knitr::include_graphics(here("./data-raw/figs-raw/bca-replication/figure20.png"))
```

In particular, the orange line in the figure above shows the Classical VAR, the black line shows the Bayesian VAR.
Both are targetting the business cycle frequency domain for unemployment.
The orange band shows the 68% bootstrapped confidence interval.
The orange line shows the median of the boostrapped VAR IRFs.

# Replication of the Bootstrapped VARs

```{r loadData, include = F}
comb_df <- fread(here("./data/replicated_bca_classical_VAR_IRF_boot.csv")) |>
    mutate(model = ifelse(model == "classical_fd", "BCA Original", model))
```

Using the Wild bootstrap with the gaussian distribution, the impulse responses are very different from the original BCA results.
```{r figCompare, echo = F, warning = F, fig.cap="Comparison of Replicated IRF to Original, Wild Bootstrap", fig.height = 3, out.width = "100%"}
comb_df |>
    filter(model != "Replication") |>
    ggplot(aes(
        x = h,
        color = model,
        fill = model
    )) +
    geom_ribbon(aes(ymin = lower, ymax = upper), color = NA, alpha = 0.3) +
    geom_line(aes(y = median)) +
    facet_wrap(vars(variable), nrow = 2, scales = "free_y") +
    scale_color_manual(values = c("firebrick", "goldenrod3")) +
    scale_fill_manual(values = c("firebrick", "goldenrod3")) +
    scale_x_continuous(limits = c(0, 20)) +
    labs(x = "Horizon", y = NULL) +
    theme_gray() +
    theme(legend.position = "bottom", strip.background = element_blank(), panel.grid.minor = element_blank())
```

